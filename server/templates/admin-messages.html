{{define "admin-content"}}
<!-- Page Header -->

<div class="mb-8">
    <div class="flex items-center mb-2">
        <h1 class="text-2xl font-bold text-green-brand mr-3">Messages</h1>
        {{if gt .Stats.NewCount 0}}
            <span class="ml-1 text-sm font-bold text-green-brand bg-green-100 rounded-full px-3 py-1">{{.Stats.NewCount}} new</span>
        {{end}}
    </div>
    <p class="text-gray-600 font-sans text-sm">
        All incoming messages from the contact form, adoption requests, and booking questions. 
        Nothing should be forgotten here.
    </p>
</div>



<!-- Filters -->
<div class="mb-8 bg-warm rounded-lg p-5 border border-gray-100 shadow-sm">
    <form id="filter-form" class="flex flex-wrap gap-8 items-start" autocomplete="off">
        <div class="flex flex-col">
            <label for="filter-name" class="block text-xs font-sans text-gray-700 mb-2 uppercase tracking-wider">NAME</label>
            <input id="filter-name" name="name" type="text" placeholder="Search by name" class="text-sm px-3 py-2 rounded border border-gray-200 focus:border-green-brand focus:outline-none w-48 bg-white font-sans" value="{{.FilterName}}">
        </div>
        <div class="flex flex-col">
            <span class="block text-xs font-sans text-gray-700 mb-2 uppercase tracking-wider">CONTACT TYPE</span>
            <div class="flex gap-2">
                <input type="hidden" name="type" id="filter-type-hidden" value="{{.FilterType}}">
                <button type="button" data-type="" class="text-xs px-3 py-1 rounded-full font-sans border transition {{if eq .FilterType ""}}bg-green-brand text-white font-bold border-green-brand{{else}}bg-white text-gray-600 border-gray-200 hover:bg-green-50{{end}}">All</button>
                <button type="button" data-type="contact" class="text-xs px-3 py-1 rounded-full font-sans border transition {{if eq .FilterType "contact"}}bg-purple-100 text-purple-700 font-semibold uppercase tracking-wide border-purple-200{{else}}bg-white text-gray-600 border-gray-200 hover:bg-purple-50{{end}}">Contact</button>
                <button type="button" data-type="adoption" class="text-xs px-3 py-1 rounded-full font-sans border transition {{if eq .FilterType "adoption"}}bg-green-100 text-green-700 font-semibold uppercase tracking-wide border-green-200{{else}}bg-white text-gray-600 border-gray-200 hover:bg-green-50{{end}}">Adoption</button>
                <button type="button" data-type="booking" class="text-xs px-3 py-1 rounded-full font-sans border transition {{if eq .FilterType "booking"}}bg-blue-100 text-blue-700 font-semibold uppercase tracking-wide border-blue-200{{else}}bg-white text-gray-600 border-gray-200 hover:bg-blue-50{{end}}">Booking</button>
            </div>
        </div>
        <div class="flex flex-col">
            <label for="filter-date" class="block text-xs font-sans text-gray-700 mb-2 uppercase tracking-wider">DATE</label>
            <input id="filter-date" name="date" type="date" class="text-sm px-3 py-2 rounded border border-gray-200 focus:border-green-brand focus:outline-none w-48 bg-white font-sans" value="{{.FilterDate}}">
        </div>
    </form>
</div>
<script>
// Auto-submit on input change
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('filter-form');
  const nameInput = document.getElementById('filter-name');
  const dateInput = document.getElementById('filter-date');
  const typeHidden = document.getElementById('filter-type-hidden');
  const typeButtons = form.querySelectorAll('button[data-type]');

  nameInput.addEventListener('input', () => form.submit());
  dateInput.addEventListener('change', () => form.submit());
  typeButtons.forEach(btn => {
    btn.addEventListener('click', function() {
      typeHidden.value = this.getAttribute('data-type');
      form.submit();
    });
  });
});
</script>



<!-- Messages List -->
<div class="bg-white rounded-lg border border-gray-100 shadow-sm">
    <!-- Removed 'All Messages' headline -->
    
    <div class="divide-y divide-gray-100">
        {{range .Messages}}
        <div class="px-5 py-4 hover:bg-warm transition-colors">
            <div class="flex items-start justify-between gap-4">
                <div class="flex-1">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="font-semibold text-gray-800 font-sans text-sm">{{.SenderName}}</span>
                        {{if eq .Status "new"}}
                        <span class="text-xs px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-sans">New</span>
                        {{else}}
                        <span class="text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-500 font-sans">Handled</span>
                        {{end}}
                    </div>
                    <p class="text-gray-600 font-sans text-sm mb-2">{{.Preview}}</p>
                    <div class="flex items-center gap-4">
                        <span class="text-xs text-gray-400 font-sans">{{.Email}}</span>
                        <span class="text-xs text-gray-400 font-sans">{{.Date}}</span>
                        <span class="text-xs px-2 py-0.5 rounded-full font-sans {{if eq .Source "contact"}}bg-purple-100 text-purple-700 font-semibold uppercase tracking-wide{{else if eq .Source "adoption"}}bg-green-100 text-green-700 font-semibold uppercase tracking-wide{{else if eq .Source "booking"}}bg-blue-100 text-blue-700 font-semibold uppercase tracking-wide{{else}}bg-gray-100 text-gray-600 font-semibold uppercase tracking-wide{{end}}">
                            {{if eq .Source "contact"}}Contact Form{{else if eq .Source "adoption"}}Adoption{{else if eq .Source "booking"}}Booking{{else}}{{.Source}}{{end}}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        {{else}}
        <div class="px-5 py-8 text-center text-gray-400 font-sans text-sm">
            No messages yet
        </div>
        {{end}}
    </div>
</div>

<p class="mt-4 text-xs text-gray-400 font-sans text-center">
    Message status is for visual reference only in this demo.
</p>
{{end}}
